import streamlit as st
import pandas as pd
import os

# ржЖржкржирж╛рж░ ржкржгрзНржпрзЗрж░ рждрж╛рж▓рж┐ржХрж╛ ржЖржорж┐ ржПржЦрж╛ржирзЗ 'ржХрзЛржб' ржмрж╛ ржерж╛рж░рзНржб ржмрзНрж░рзНржпрж╛ржХрзЗржЯрзЗрж░ ржнрзЗрждрж░рзЗ ржмрж╕рж┐рзЯрзЗ ржжрж┐рзЯрзЗржЫрж┐
products = [
    "ржЪрж╛рж▓ (рж╕рж░рзБ)", "ржЪрж╛рж▓ (ржорзЛржЯрж╛)", "ржЪрж╛рж▓ (ржмрж╛рж╕ржорждрж┐)", "ржЪрж╛рж▓ (ржЖрждржк)", "ржорзБржЧ ржбрж╛рж▓", "ржорж╕рзБрж░ ржбрж╛рж▓", "ржЫрзЛрж▓рж╛ ржбрж╛рж▓", 
    "ржХрж▓рж╛ржЗ ржбрж╛рж▓", "ржЕрзЬрж╣рж░ ржбрж╛рж▓", "ржЪрж┐ржирж┐", "рж▓рж╛рж▓ ржЪрж┐ржирж┐", "рж▓ржмржг", "рж╕рзЯрж╛ржмрж┐ржи рждрзЗрж▓ (рззрж▓рж┐)", "рж╕рзЯрж╛ржмрж┐ржи рждрзЗрж▓ (рзлрж▓рж┐)", 
    "рж╕рж░рзНрж╖рзЗрж░ рждрзЗрж▓ (рзлрзжрзжржорж┐)", "рж╕рж░рзНрж╖рзЗрж░ рждрзЗрж▓ (рззрж▓рж┐)", "ржШрж┐", "ржЖржЯрж╛", "ржорзЯржжрж╛", "рж╕рзБржЬрж┐", "ржмрзЗрж╕ржи", "ржЫрзЛрж▓рж╛", 
    "ржорзБрзЬрж┐", "ржЪрж┐ржБрзЬрзЗ", "рж╕рж╛ржмрзБржжрж╛ржи", "ржЪрж╛ ржкрж╛рждрж╛ (ржЫрзЛржЯ)", "ржЪрж╛ ржкрж╛рждрж╛ (ржмрзЬ)", "ржХржлрж┐", "ржЧрзБржБрзЬрзЛ ржжрзБржз", 
    "ржмрж┐рж╕рзНржХрзБржЯ (ржорзЗрж░рж┐)", "ржмрж┐рж╕рзНржХрзБржЯ (ржЧрзБржб ржбрзЗ)", "ржмрж┐рж╕рзНржХрзБржЯ (ржирзЛржирждрж╛)", "ржЪрж╛ржирж╛ржЪрзБрж░", "ржнрзБржЬрж┐ржпрж╝рж╛", "ржЪрж┐ржкрж╕", 
    "рж╣рж▓рзБржж ржЧрзБржБрзЬрзЛ", "рж▓ржЩрзНржХрж╛ ржЧрзБржБрзЬрзЛ", "ржЬрж┐рж░рзЗ ржЧрзБржБрзЬрзЛ", "ржзржирзЗ ржЧрзБржБрзЬрзЛ", "ржкрж╛ржБржЪржлрзЛрзЬржи", "ржЧрж░ржо ржорж╢рж▓рж╛", 
    "рждрзЗржЬржкрж╛рждрж╛", "рж╢рзБржХржирзЛ рж▓ржЩрзНржХрж╛", "ржЧрзЛржЯрж╛ ржЬрж┐рж░рзЗ", "ржПрж▓рж╛ржЪ", "рж▓ржмржЩрзНржЧ", "ржжрж╛рж░рзБржЪрж┐ржирж┐", "ржЧрзЛрж▓ржорж░рж┐ржЪ", 
    "ржЖржжрж╛", "рж░рж╕рзБржи", "ржкрзЗржБржпрж╝рж╛ржЬ", "ржЖрж▓рзБ", "рж╕рзНржирж╛ржирзЗрж░ рж╕рж╛ржмрж╛ржи (рж▓рж╛ржХрзНрж╕)", "рж╕рзНржирж╛ржирзЗрж░ рж╕рж╛ржмрж╛ржи (ржбрзЗржЯрж▓)", 
    "ржХрж╛ржкрзЬ ржХрж╛ржЪрж╛рж░ рж╕рж╛ржмрж╛ржи", "ржбрж┐ржЯрж╛рж░ржЬрзЗржирзНржЯ ржкрж╛ржЙржбрж╛рж░", "ржмрж╛рж╕ржи ржорж╛ржЬрж╛рж░ рж╕рж╛ржмрж╛ржи", "рж╣рзНржпрж╛ржирзНржб ржУрзЯрж╛рж╢", 
    "ржЯрзБржержкрзЗрж╕рзНржЯ (ржХрзЛрж▓ржЧрзЗржЯ)", "ржЯрзБржержмрзНрж░рж╛рж╢", "ржирж╛рж░ржХрзЗрж▓ рждрзЗрж▓", "ржмржбрж┐ рж▓рзЛрж╢ржи", "ржкрж╛ржЙржбрж╛рж░", "ржЖржЧрж░ржмрж╛рждрж┐", 
    "ржжрзЗрж╢рж▓рж╛ржЗ", "ржорзЛржоржмрж╛рждрж┐", "ржорж╢рж╛ ржорж╛рж░рж╛рж░ ржзрзВржк", "рж╣рж╛рж░ржкрж┐ржХ", "ржЯрж┐рж╕рзНржпрзБ ржкрзЗржкрж╛рж░", "ржбрж┐ржо", "ржкрж╛ржЙрж░рзБржЯрж┐", 
    "ржорж╛ржЦржи", "ржарж╛ржгрзНржбрж╛ ржкрж╛ржирзАржпрж╝ (ржХрзЛржХ)", "ржЬрзБрж╕", "рж╣рж░рж▓рж┐ржХрзНрж╕", "ржоржзрзБ", "ржЕржирзНржпрж╛ржирзНржп"
]

file_name = "dokan_hishab.csv"

st.set_page_config(page_title="ржбрж┐ржЬрж┐ржЯрж╛рж▓ ржЦрж╛рждрж╛", layout="wide")
st.title("ЁЯПк ржорзБржжрж┐ржЦрж╛ржирж╛ ржбрж┐ржЬрж┐ржЯрж╛рж▓ ржЦрж╛рждрж╛")

# ржПржирзНржЯрзНрж░рж┐ ржлрж░ржо
st.subheader("ЁЯЫТ ржкржгрзНржп ржУ ржУржЬржи ржПржирзНржЯрзНрж░рж┐ ржХрж░рзБржи")
col1, col2, col3, col4 = st.columns(4)

with col1:
    # ржПржЦрж╛ржирзЗ ржирж╛ржоржЧрзБрж▓рзЛ рж╕рж┐рж░рж┐рзЯрж╛рж▓ ржЕржирзБржпрж╛рзЯрзА (ржХ-ржЦ-ржЧ) ржЖрж╕ржмрзЗ
    item = st.selectbox("ржкржгрзНржпржЯрж┐ ржмрзЗржЫрзЗ ржирж┐ржи:", sorted(products))

with col2:
    weight = st.number_input("ржУржЬржи ржмрж╛ ржкрж░рж┐ржорж╛ржг рж▓рж┐ржЦрзБржи:", min_value=0.0, step=0.01, format="%.2f")

with col3:
    unit = st.selectbox("ржПржХржХ:", ["ржХрзЗржЬрж┐ (kg)", "ржЧрзНрж░рж╛ржо (gm)", "ржкрж┐рж╕ (pcs)"])

with col4:
    rate = st.number_input("рзз ржХрзЗржЬрж┐/ржкрж┐рж╕ ржПрж░ ржжрж╛ржо:", min_value=0.0)

# рж╣рж┐рж╕рж╛ржмрзЗрж░ ржирж┐рзЯржо
if unit == "ржЧрзНрж░рж╛ржо (gm)":
    total = (rate / 1000) * weight
else:
    total = rate * weight

if st.button("тЬЕ рж╣рж┐рж╕рж╛ржм рж╕рзЗржн ржХрж░рзБржи"):
    new_data = pd.DataFrame([[item, weight, unit, rate, total]], 
                            columns=["ржкржгрзНржп", "ржкрж░рж┐ржорж╛ржг", "ржПржХржХ", "ржжрж░", "ржорзЛржЯ ржЯрж╛ржХрж╛"])
    
    if not os.path.isfile(file_name):
        new_data.to_csv(file_name, index=False)
    else:
        new_data.to_csv(file_name, mode='a', header=False, index=False)
    
    st.success(f"рж╕рзЗржн рж╣рзЯрзЗржЫрзЗ! ржорзЛржЯ ржжрж╛ржо: {total:.2f} ржЯрж╛ржХрж╛")
    st.balloons()

# ржмрж┐ржХрзНрж░рж┐рж░ рждрж╛рж▓рж┐ржХрж╛
st.divider()
st.subheader("ЁЯУК ржЖржЬржХрзЗрж░ ржорзЛржЯ ржмрж┐ржХрзНрж░рж┐рж░ рждрж╛рж▓рж┐ржХрж╛")
if os.path.isfile(file_name):
    df = pd.read_csv(file_name)
    st.dataframe(df, use_container_width=True)
    st.info(f"ЁЯТ░ рж╕рж░рзНржмржорзЛржЯ ржХрзНржпрж╛рж╢: {df['ржорзЛржЯ ржЯрж╛ржХрж╛'].sum():.2f} ржЯрж╛ржХрж╛")